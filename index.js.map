{"version":3,"file":"index.js","sources":["../src/js/main.js"],"sourcesContent":["// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled\n\n// Мікро процеси мають більший пріорітет ніж макро\n\n// Мікро процеси\n// 1 Promise\n// 2 Observer\n\n// Макро процеси\n// 1 setTimeout\n// 2 setInterval\n// https://developer.mozilla.org/en-US/docs/Web/API/Window/setImmediate\n// 3 setImmediate\n//https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\n// 4 requestAnimationFrame\n\nfunction fetchUserByName(userName) {\n  return new Promise((resolve, reject) => {\n    console.log(`Fetching data for ${userName}`);\n\n    const isSuccess = Math.random() > 0.5;\n\n    if (isSuccess) {\n      resolve(`My success value ${userName}`);\n    } else {\n      reject('My error');\n    }\n  });\n}\n\nconsole.log(fetchUserByName('Poly'));\n\nfetchUserByName('Mango')\n  .then(value => console.log(value))\n  .catch(error => console.log(error))\n  .finally(() => {\n    console.log('test message from finally');\n  });\n\nconsole.log('1');\n\nsetTimeout(() => console.log('2'), 10);\n\nPromise.reject('4')\n  .then(value => console.log(value))\n  .catch(err => console.log(err));\nPromise.resolve('3')\n  .then(value => {\n    console.log(value);\n    return value;\n  })\n  .then(value => console.log(value));\nPromise.resolve('5').then(value => console.log(value));\nsetTimeout(() => console.log('6'), 0);\nconsole.log('7');\n\n// console.log(\"1\");\n// setTimeout(() => {\n//   console.log(\"2\");\n//   Promise.resolve('3').then(value => console.log(value))\n// }, 10);\n\n// console.log(\"4\");\n\n// const promise = new Promise((res, rej) => {\n//   setTimeout(() => {\n//     const val = Math.random();\n//     if (val > 0.2) {\n//       res(\"Yeeees\");\n//     } else {\n//       rej(\"Noooo\");\n//     }\n//   }, 3000);\n// });\n// console.log(promise);\n\n// promise\n//   .then((value) => {\n//     return value + \" 😎\";\n//   })\n//   .then((value) => {\n//     console.log(value, qwerty);\n//   })\n//   .then(()=>{console.log('last then')})\n//   .catch((err) => {\n//     console.log(err);\n//   })\n//   .finally(() => {\n//     console.log(\"after\");\n//   });\n\n// const promise = fetch(\"https://pokeapi.co/api/v2/pokemon/ditto\");\n\n// console.log(promise);\n\n// promise\n// .then((resp) => resp.json())\n// .then(data => console.log(data))\n// .catch((err) => console.log(err));\n\nconst refs = {\n  result: document.querySelector('.js-result'),\n};\n\nconst start = document.querySelector('.js-start');\nconst container = document.querySelector('.js-container');\n\nstart.addEventListener('click', onStart);\n\n// function onStart() {\n//   const result = [];\n//   [...container.children].forEach((box) => (box.textContent = \"\"));\n//   [...container.children].forEach((box, i) => {\n//     createPromise(i)\n//       .then((smile) => {\n//         box.textContent = smile;\n//         result.push(\"1\");\n//       })\n//       .catch((smile) => (box.textContent = smile))\n//       .finally(() => {\n//         setTimeout(() => {\n//           if (i === container.children.length - 1) {\n//             if (!result.length || result.length === 3) {\n//               alert(\"Winner\");\n//             } else {\n//               alert(\"Lost money\");\n//             }\n//           }\n//         },500);\n//       });\n//   });\n// }\n\n// function createPromise(delay) {\n//   return new Promise((res, rej) => {\n//     setTimeout(() => {\n//       const random = Math.random();\n//       if (random > 0.1) {\n//         res(\"🤑\");\n//       } else {\n//         rej(\"😈\");\n//       }\n//     }, 1000 * delay);\n//   });\n// }\n\nfunction onStart() {\n  let counter = 0;\n\n  [...container.children].forEach(box => (box.textContent = ''));\n\n  const promises = [...container.children].map((_, i) => createPromise(i));\n\n  Promise.allSettled(promises).then(items => {\n    console.log(items);\n    items.forEach((item, i) => {\n      setTimeout(() => {\n        if (item.status === 'fulfilled') {\n          counter += 1;\n        }\n        console.log(item);\n        container.children[i].textContent = item.value || item.reason;\n        refs.result.textContent = 'Loading';\n\n        if (container.children.length - 1 === i) {\n          setTimeout(() => {\n            if (counter === container.children.length || !counter) {\n              refs.result.textContent = 'Winner';\n            } else {\n              refs.result.textContent = 'Try again';\n            }\n          }, 500);\n        }\n      }, i * 1000);\n    });\n  });\n}\n\nfunction createPromise() {\n  return new Promise((res, rej) => {\n    const random = Math.random();\n    if (random > 0.5) {\n      res('🤑');\n    } else {\n      rej('😈');\n    }\n  });\n}\n"],"names":["fetchUserByName","userName","resolve","reject","value","error","err","refs","start","container","onStart","counter","box","promises","_","i","createPromise","items","item","res","rej"],"mappings":"yuBAgBA,SAASA,EAAgBC,EAAU,CACjC,OAAO,IAAI,QAAQ,CAACC,EAASC,IAAW,CACtC,QAAQ,IAAI,qBAAqBF,CAAQ,EAAE,EAEzB,KAAK,OAAM,EAAK,GAGhCC,EAAQ,oBAAoBD,CAAQ,EAAE,EAEtCE,EAAO,UAAU,CAEvB,CAAG,CACH,CAEA,QAAQ,IAAIH,EAAgB,MAAM,CAAC,EAEnCA,EAAgB,OAAO,EACpB,KAAKI,GAAS,QAAQ,IAAIA,CAAK,CAAC,EAChC,MAAMC,GAAS,QAAQ,IAAIA,CAAK,CAAC,EACjC,QAAQ,IAAM,CACb,QAAQ,IAAI,2BAA2B,CAC3C,CAAG,EAEH,QAAQ,IAAI,GAAG,EAEf,WAAW,IAAM,QAAQ,IAAI,GAAG,EAAG,EAAE,EAErC,QAAQ,OAAO,GAAG,EACf,KAAKD,GAAS,QAAQ,IAAIA,CAAK,CAAC,EAChC,MAAME,GAAO,QAAQ,IAAIA,CAAG,CAAC,EAChC,QAAQ,QAAQ,GAAG,EAChB,KAAKF,IACJ,QAAQ,IAAIA,CAAK,EACVA,EACR,EACA,KAAKA,GAAS,QAAQ,IAAIA,CAAK,CAAC,EACnC,QAAQ,QAAQ,GAAG,EAAE,KAAKA,GAAS,QAAQ,IAAIA,CAAK,CAAC,EACrD,WAAW,IAAM,QAAQ,IAAI,GAAG,EAAG,CAAC,EACpC,QAAQ,IAAI,GAAG,EA8Cf,MAAMG,EAAO,CACX,OAAQ,SAAS,cAAc,YAAY,CAC7C,EAEMC,EAAQ,SAAS,cAAc,WAAW,EAC1CC,EAAY,SAAS,cAAc,eAAe,EAExDD,EAAM,iBAAiB,QAASE,CAAO,EAuCvC,SAASA,GAAU,CACjB,IAAIC,EAAU,EAEd,CAAC,GAAGF,EAAU,QAAQ,EAAE,QAAQG,GAAQA,EAAI,YAAc,EAAG,EAE7D,MAAMC,EAAW,CAAC,GAAGJ,EAAU,QAAQ,EAAE,IAAI,CAACK,EAAGC,IAAMC,EAAe,CAAC,EAEvE,QAAQ,WAAWH,CAAQ,EAAE,KAAKI,GAAS,CACzC,QAAQ,IAAIA,CAAK,EACjBA,EAAM,QAAQ,CAACC,EAAMH,IAAM,CACzB,WAAW,IAAM,CACXG,EAAK,SAAW,cAClBP,GAAW,GAEb,QAAQ,IAAIO,CAAI,EAChBT,EAAU,SAASM,CAAC,EAAE,YAAcG,EAAK,OAASA,EAAK,OACvDX,EAAK,OAAO,YAAc,UAEtBE,EAAU,SAAS,OAAS,IAAMM,GACpC,WAAW,IAAM,CACXJ,IAAYF,EAAU,SAAS,QAAU,CAACE,EAC5CJ,EAAK,OAAO,YAAc,SAE1BA,EAAK,OAAO,YAAc,WAE7B,EAAE,GAAG,CAEhB,EAASQ,EAAI,GAAI,CACjB,CAAK,CACL,CAAG,CACH,CAEA,SAASC,GAAgB,CACvB,OAAO,IAAI,QAAQ,CAACG,EAAKC,IAAQ,CAChB,KAAK,OAAQ,EACf,GACXD,EAAI,IAAI,EAERC,EAAI,IAAI,CAEd,CAAG,CACH"}